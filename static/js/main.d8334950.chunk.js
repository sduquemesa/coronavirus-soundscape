(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{180:function(e,t,a){"use strict";a.r(t);var i=a(0),s=a.n(i),r=a(21),n=a.n(r),o=(a(73),a(3)),l=a(4),h=a(9),c=a(8),u=a(10),d=(a(45),a(43)),p=a(6),f=a(31),v=a.n(f),y=function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,null,[{key:"makeHex",value:function(e){var t=v()(e);return[t.red(),t.green(),t.blue()]}},{key:"makeRGB",value:function(e,t,a){return[e,t,a]}},{key:"makeHSL",value:function(e,t,a){var i=v.a.hsl(e,t,a);return[i.red(),i.green(),i.blue()]}},{key:"blend",value:function(e,t,a){return[(t[0]-e[0])*a+e[0],(t[1]-e[1])*a+e[1],(t[2]-e[2])*a+e[2]]}},{key:"withAlpha",value:function(e,t){return[e[0],e[1],e[2],t]}},{key:"r",value:function(e){return e[0]}},{key:"g",value:function(e){return e[1]}},{key:"b",value:function(e){return e[2]}},{key:"a",value:function(e){return 4===e.length?e[3]:255}},{key:"hue",value:function(e){var t=e[0]/255,a=e[1]/255,i=e[2]/255,s=Math.min(t,a,i),r=Math.max(t,a,i),n=NaN,o=r-s,l=(r+s)/2;return o?(n=t===r?(a-i)/o+6*(a<i):a===r?(i-t)/o+2:(t-a)/o+4,o/=l<.5?r+s:2-r-s,n*=60):o=l>0&&l<1?0:n,n}},{key:"__helperRep",value:function(t){return v.a.rgb(e.r(t),e.g(t),e.b(t),e.a(t))}},{key:"__fromHelperRep",value:function(e){return[e.red(),e.green(),e.blue()]}},{key:"hex",value:function(t){return e.__helperRep(t).toString()}},{key:"opacity",value:function(t){return e.a(t)/255}},{key:"lighten",value:function(t,a){return e.__fromHelperRep(e.__helperRep(t).whiten(a))}}]),e}(),m=function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,null,[{key:"assert",value:function(e,t){e||(console.log("ACK!",t),alert("ACK! "+t))}},{key:"makeImageUri",value:function(e){var t=-1,a=!0,i=!1,s=void 0;try{for(var r,n=e[Symbol.iterator]();!(a=(r=n.next()).done);a=!0){var o=r.value;o.length>t&&(t=o.length)}}catch(P){i=!0,s=P}finally{try{a||null==n.return||n.return()}finally{if(i)throw s}}for(var l=e.length,h=new Uint8ClampedArray(t*l*4),c=0;c<l;c++){for(var u=e[c].length,d=Math.floor((t-u)/2),p=t-u-d,f=0;f<u;f++){var v=e[c][f],m=4*(c*t+d+f);h[m]=y.r(v),h[m+1]=y.g(v),h[m+2]=y.b(v),h[m+3]=y.a(v)}for(var g=0;g<d;g++){var E=4*(c*t+g);h[E]=255,h[E+1]=255,h[E+2]=255,h[E+3]=255}for(var S=u+p;S<t;S++){var D=4*(c*t+S);h[D]=255,h[D+1]=255,h[D+2]=255,h[D+3]=255}}var w=document.createElement("canvas"),b=w.getContext("2d");w.width=t,w.height=l;var k=b.createImageData(t,l);return k.data.set(h),b.putImageData(k,0,0),w.toDataURL()}},{key:"arraysEqual",value:function(t,a){if(t.length!==a.length)return!1;for(var i=0;i<t.length;i++){var s=t[i],r=a[i],n=s===r;if(Array.isArray(s)&&Array.isArray(r)&&(n=e.arraysEqual(s,r)),!n)return!1}return!0}}]),e}(),g=a(67),E=a.n(g),S=function(){function e(t){Object(o.a)(this,e),null!==t&&void 0!==t||(t=Math.floor(Math.random()*e.m)),this.lastX=Math.floor(t)}return Object(l.a)(e,[{key:"random",value:function(){return this.lastX=(e.a*this.lastX+e.c)%e.m,this.lastX/e.m}},{key:"randBetween",value:function(e,t){return this.random()*(t-e)+e}},{key:"randIntBetween",value:function(e,t){var a=this.random()*(t-e+1);return Math.floor(a)+e}}]),e}();S.m=2147483648,S.a=214013,S.c=2531011;var D=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(h.a)(this,Object(c.a)(t).call(this,e))).initializeFromProps(a.props,!0),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){this.initializeFromProps(e,!1)}},{key:"initializeFromProps",value:function(e,t){var a={};t?this.state=a:this.setState(a),null!==this.interval&&void 0!==this.interval&&clearInterval(this.interval),this.interval=setInterval(e.callback,e.milliseconds)}},{key:"render",value:function(){return null}}]),t}(i.Component);D.defaultProps={};var w=function e(){Object(o.a)(this,e)};w.SUSCEPTIBLE_COLOR="#EEE",w.EXPOSED_COLOR="#ffdde2",w.INFECTED_COLOR="#F44",w.ISOLATING_COLOR="#8094ff",w.REMOVED_COLOR="#999",w.DEAD_COLOR="#000",w.QUARENTINE_COLOR="#e1e7f0",w.QUARENTINE_STROKE="#a3aab5",w.SUSCEPTIBLE=0,w.QUARENTINE=1,w.EXPOSED=2,w.INFECTED=3,w.REMOVED=4,w.DEAD=5;var b=function(){function e(t,a,i){Object(o.a)(this,e),this.r=a,this.c=i,this.state=w.SUSCEPTIBLE,this.nextState=w.SUSCEPTIBLE,this.daysInState=0,this.linked=!1,this.mediaOutlet=!1,this.specialDegree=null,this.dead=!1,this.isolating=!1,this.quarentine=!1,this.rng=t}return Object(l.a)(e,[{key:"getState",value:function(){return this.state}},{key:"getNextState",value:function(){return this.nextState}},{key:"isSusceptible",value:function(){return this.state===w.SUSCEPTIBLE}},{key:"isExposed",value:function(){return this.state===w.EXPOSED}},{key:"isInfected",value:function(){return this.state===w.INFECTED}},{key:"canInfectOthers",value:function(){return this.state===w.EXPOSED||this.state===w.INFECTED}},{key:"isRemoved",value:function(){return this.state===w.REMOVED}},{key:"isDead",value:function(){return this.state===w.DEAD}},{key:"isAllowedToBeRemoved",value:function(){return!this.linked}},{key:"_setState",value:function(e){this.state=e}},{key:"setNextState",value:function(e){this.nextState=e}},{key:"setSusceptible",value:function(){this._setState(w.SUSCEPTIBLE)}},{key:"setExposed",value:function(){this._setState(w.EXPOSED)}},{key:"setInfected",value:function(){this._setState(w.INFECTED)}},{key:"setRemoved",value:function(){this._setState(w.REMOVED)}},{key:"setDead",value:function(){this._setState(w.DEAD)}},{key:"startDay",value:function(){this.nextState=this.state}},{key:"setInQuarentine",value:function(){this._setState(w.QUARENTINE)}},{key:"isIsolating",value:function(){return this.isolating}},{key:"isInQuarentine",value:function(){return this.quarentine}},{key:"tryToInfect",value:function(e,t){if(e.isSusceptible()&&this.rng.random()<t){e.setNextState(w.EXPOSED)}}},{key:"maybeIsolate",value:function(e){this.rng.random()<e&&(this.isolating=!0)}},{key:"endDay",value:function(e,t,a,i,s,r){this.nextState!==this.state?(this.nextState===w.EXPOSED&&0===t&&(this.nextState=w.INFECTED,this.maybeIsolate(r)),this._setState(this.nextState),this.daysInState=0):(this.daysInState++,this.isExposed()?this.daysInState>=t&&(this.setInfected(),this.maybeIsolate(r),this.daysInState=0):this.isInfected()&&this.daysInState>=a&&(e&&(s*=2),i||(s=0),this.rng.random()<s?this.setDead():this.setRemoved(),this.daysInState=0))}}]),e}(),k=a(64),P=a(66),O=a.n(P),C=a(182),I=Object(C.withStyles)({root:{background:"linear-gradient(0deg, #f0f0f0 30%, #f8f8f8 90%)"},label:{textTransform:"capitalize"}})(O.a),R=Object(C.withStyles)({root:{background:"linear-gradient(0deg, #ccddff 30%, #ddeeff 90%)"},label:{textTransform:"capitalize"}})(I),N=function(e){function t(){return Object(o.a)(this,t),Object(h.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t={margin:"0.5rem"};return"small"===this.props.size&&(t={margin:"0.5rem",maxWidth:"30px",maxHeight:"30px",minWidth:"30px",minHeight:"30px"}),this.props.highlighted?s.a.createElement(R,{variant:"contained",onClick:function(t){t.preventDefault(),e.props.onClick(t)},style:t},this.props.children):s.a.createElement(I,{variant:"contained",onClick:function(t){t.preventDefault(),e.props.onClick(t)},style:t},this.props.children)}}]),t}(s.a.PureComponent),x=function(e){function t(){return Object(o.a)(this,t),Object(h.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=w.SUSCEPTIBLE_COLOR;return"exposed"===this.props.type?e=w.EXPOSED_COLOR:"infected"===this.props.type?e=w.INFECTED_COLOR:"removed"===this.props.type?e=w.REMOVED_COLOR:"dead"===this.props.type&&(e=w.DEAD_COLOR),s.a.createElement("div",{style:{marginBottom:"-2px",border:"1px black solid",width:"1rem",height:"1rem",backgroundColor:e,display:"inline-block"}})}}]),t}(i.Component),A=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(h.a)(this,Object(c.a)(t).call(this,e))).width=null,a.height=150,a.canvasRef=s.a.createRef(),a.state={showDead:!0,showInfected:!0,showRecovered:!0},a.componentWillReceiveProps(e),a.updateWindowDimensions=a.updateWindowDimensions.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"updateWindowDimensions",value:function(){var e=Math.min(600,document.documentElement.clientWidth-60);this.width!==e&&(this.width=e,this.redraw())}},{key:"componentWillReceiveProps",value:function(e,t){this.updateMaxValues(e)}},{key:"updateMaxValues",value:function(e){this.maxValue=1;var t=[];this.state.showInfected&&t.push(e.infectedPerDay),this.state.showRecovered&&t.push(e.recoveredPerDay),this.state.showDead&&t.push(e.deadPerDay),e.hospitalCapacity>-1&&t.push(e.capacityPerDay);for(var a=0;a<e.infectedPerDay.length;a++)for(var i=0;i<t.length;i++){var s=t[i][a];null!==s&&s>this.maxValue&&(this.maxValue=s)}this.maxValue*=1.1,this.maxValue=this.props.population,this.maxDay=Math.max(e.infectedPerDay.length-1,1)}},{key:"componentDidMount",value:function(){this.canvas=this.canvasRef.current,this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),this.redraw()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"showHospitalCapacity",value:function(){return this.props.hospitalCapacity>-1}},{key:"redraw",value:function(){if(null!==this.canvas&&void 0!==this.canvas){this.updateMaxValues(this.props);var e=this.canvas.getContext("2d");e.fillStyle=w.SUSCEPTIBLE_COLOR,e.fillRect(0,0,this.width,this.height),e.setLineDash([]),e.lineWidth=2;for(var t=[],a=[],i=[],s=[],r=[],n=[],o=0;o<this.props.infectedPerDay.length;o++){var l=o,h=this.props.infectedPerDay[l],c=this.props.recoveredPerDay[l],u=this.props.deadPerDay[l],d=(this.props.population,this.props.capacityPerDay[l]);null===h?(this.drawPath(t,a,e,w.INFECTED_COLOR),this.drawPath(a,i,e,"#A8A8A8"),this.drawPath(i,s,e,w.DEAD_COLOR),this.showHospitalCapacity()&&this.drawPath(n,n,e,"#000"),t.length=0,a.length=0,i.length=0,s.length=0,r.length=0,n.length=0):(t.push([this.xcoord(l),this.ycoord(0)]),a.push([this.xcoord(l),this.ycoord(h)]),i.push([this.xcoord(l),this.ycoord(h+c)]),s.push([this.xcoord(l),this.ycoord(h+c+u)]),r.push([this.xcoord(l),this.ycoord(this.maxValue)]),n.push([this.xcoord(l),this.ycoord(d)]))}this.drawPath(t,a,e,w.INFECTED_COLOR),this.drawPath(a,i,e,"#A8A8A8"),this.drawPath(i,s,e,w.DEAD_COLOR),this.showHospitalCapacity()&&this.drawPath(n,n,e,"#000");for(var p=0;p<this.props.infectedPerDay.length;p++){var f=p;null===this.props.infectedPerDay[f]&&(e.strokeStyle="#000",e.lineWidth=2,e.setLineDash([5,5]),this.drawLine(e,f-1,0,f-1,this.maxValue))}e.strokeStyle="#000",e.setLineDash([]),e.lineWidth=1,this.drawLine(e,0,0,0,this.maxValue),this.drawLine(e,0,0,this.maxDay,0)}}},{key:"drawPath",value:function(e,t,a,i){if(0!==e.length){a.beginPath(),a.moveTo(e[0][0],e[0][1]);for(var s=0;s<e.length;s++)a.lineTo(e[s][0],e[s][1]);if(e!==t)for(var r=t.length-1;r>=0;r--)a.lineTo(t[r][0],t[r][1]);e===t?(a.strokeStyle=i,a.lineWidth=2,a.setLineDash([5,5]),a.stroke()):(a.fillStyle=i,a.fill())}}},{key:"drawSeries",value:function(e,t){for(var a=1;a<e.length;a++){var i=a-1,s=a,r=e[i],n=e[s];null!==r&&null!==n&&this.drawLine(t,i,r,s,n)}}},{key:"xcoord",value:function(e){return this.width*e/this.maxDay}},{key:"ycoord",value:function(e){return(this.height-1)*(1-e/this.maxValue)}},{key:"drawBar",value:function(e,t,a,i,s){var r=this.xcoord(t),n=this.xcoord(i),o=this.ycoord(a),l=this.ycoord(s);e.fillRect(r,o,n-r,l-o)}},{key:"drawLine",value:function(e,t,a,i,s){e.beginPath(),e.moveTo(this.xcoord(t),this.ycoord(a)),e.lineTo(this.xcoord(i),this.ycoord(s)),e.stroke()}},{key:"resetArrays",value:function(){this.props.capacityPerDay.length=0,this.props.deadPerDay.length=0,this.props.infectedPerDay.length=0,this.props.recoveredPerDay.length=0,this.redraw(),this.forceUpdate()}},{key:"render",value:function(){this.redraw();var e=Math.round(this.props.infectedPerDay[this.props.infectedPerDay.length-1]/this.props.population*100),t=Math.round(this.props.recoveredPerDay[this.props.recoveredPerDay.length-1]/this.props.population*100),a=Math.round(this.props.deadPerDay[this.props.deadPerDay.length-1]/this.props.population*100);isNaN(e)&&(e=0),isNaN(t)&&(t=0),isNaN(a)&&(a=0);s.a.createElement("span",null,s.a.createElement(x,{type:"infected"})," \xa0Infected: ",e,"%"),s.a.createElement("span",null,s.a.createElement(x,{type:"removed"})," \xa0Recovered: ",t,"%");this.props.showDeaths&&s.a.createElement("span",null,s.a.createElement(x,{type:"dead"})," ",s.a.createElement("span",{style:{backgroundColor:"#FFA"}},"\xa0Dead: ",a,"%\xa0"));var i=this.width;return null===i&&(i=300),s.a.createElement("div",null,s.a.createElement("div",{className:"plot-container"},s.a.createElement("div",{className:"plot-chart"},s.a.createElement("canvas",{className:"canvas",ref:this.canvasRef,width:i,height:this.height})),s.a.createElement("div",{className:"plot-xaxis"},"time \u27f6")))}}]),t}(i.Component),T=a(22),M=function(){function e(t){var a=this;Object(o.a)(this,e),this.oscillators=[];for(var i=0;i<t;i++){var s=new T.Oscillator;this.oscillators.push(s)}this.oscillatorsGain=[];for(var r=0;r<t;r++){var n=new T.Gain;this.oscillatorsGain.push(n)}this.masterGain=new T.Gain,this.oscillators.map(function(e,t){a.oscillators[t].connect(a.oscillatorsGain[t]),a.oscillatorsGain[t].connect(a.masterGain),a.oscillatorsGain[t].gain.value=.2}),this.masterGain.gain.value=1/this.oscillators.length}return Object(l.a)(e,[{key:"connect",value:function(){this.masterGain.connect(T.Master)}},{key:"disconnect",value:function(){this.masterGain.disconnect()}},{key:"start",value:function(){this.oscillators.forEach(function(e){return e.start()})}},{key:"stop",value:function(){this.oscillators.forEach(function(e){return e.stop()})}},{key:"setFrequency",value:function(e,t){this.oscillators.forEach(function(a,i){Math.random()<.01?a.frequency.exponentialRampToValueAtTime(e[i],"+"+t.toString()):a.frequency.value=e[i]})}},{key:"setOscType",value:function(e){this.oscillators.forEach(function(t,a){t.type=e[a]})}},{key:"setOscGain",value:function(e){this.oscillatorsGain.forEach(function(t,a){t.gain.value=e[a]})}}]),e}(),L=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(h.a)(this,Object(c.a)(t).call(this,e))).canvasRef=s.a.createRef(),a.previousSimulationParams=["foo"],a.previousDrawingParams=[],a.previousInteractionsParams=[],a.onTick=a.onTick.bind(Object(p.a)(Object(p.a)(a))),a.onEnter=a.onEnter.bind(Object(p.a)(Object(p.a)(a))),a.onLeave=a.onLeave.bind(Object(p.a)(Object(p.a)(a))),a.oscillators=new M(36),a.oscillators.connect(),a.initializeFromProps(a.props,!0),a.updateWindowDimensions=a.updateWindowDimensions.bind(Object(p.a)(Object(p.a)(a))),a.frequencies=[];for(var i=w.DEAD+1,r=0;r<i;r++)a.frequencies.push(1800*Math.random()+200);return a.frequencies=a.frequencies.sort(function(e,t){return e-t}),a.oscillatorType=["sine","sine","sine","sine2","sine2","triangle"],a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"updateWindowDimensions",value:function(){var e=this.props.gridCols*this.props.nodeSize;this.props.nodeSize>=5&&(e+=this.props.gridCols);var t=Math.min(e,document.documentElement.clientWidth-40),a=Math.floor(t/this.props.gridCols);t=a*this.props.gridCols,this.gridWidth===t&&this.nodeSize===a||(this.gridWidth=t,this.nodeSize=a,this.redraw(!0))}},{key:"componentWillReceiveProps",value:function(e,t){}},{key:"initializeFromProps",value:function(e,t){this.gridWidth=e.gridCols*e.nodeSize,this.nodeSize=e.nodeSize;var a=e.randomSeed;-1===a&&(a=Math.floor(3e6*Math.random())),this.rng=new S(a);var i={numActiveNodes:0,playing:!1,visible:!1,daysIncubating:e.daysIncubating,daysSymptomatic:e.daysSymptomatic,deathRate:e.deathRate,decreaseInEncountersAfterSymptoms:e.decreaseInEncountersAfterSymptoms,chanceOfIsolationAfterSymptoms:e.chanceOfIsolationAfterSymptoms,hospitalCapacityPct:e.hospitalCapacityPct,immunityFraction:e.immunityFraction,longDistaceNetworkActive:e.addLinkedNodes,maxIterations:e.maxIterations,personHours:e.personHours,transmissionProbability:e.transmissionProbability,travelRadius:e.travelRadius,centerNodeNeighborsToDisplay:[],drawNodeOutlines:e.drawNodeOutlines,hospitalCapacitySliderHighlighted:!1,speed:e.speed,capacityPerDay:[],deadPerDay:[],infectedPerDay:[],recoveredPerDay:[]};t?this.state=i:this.setState(i)}},{key:"componentDidMount",value:function(){this.canvas=this.canvasRef.current,this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),this.redraw(!0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"onTick",value:function(){this.state.playing&&this.state.visible&&(this.simulateStep(),this.redraw(!0))}},{key:"onEnter",value:function(){this.setState({visible:!0}),this.redraw(!0)}},{key:"onLeave",value:function(){this.setState({visible:!1})}},{key:"regenerate",value:function(){this.generate(),this.forceUpdate()}},{key:"resetPlotVariables",value:function(){this.state.capacityPerDay=[],this.state.deadPerDay=[],this.state.infectedPerDay=[],this.state.recoveredPerDay=[]}},{key:"generate",value:function(e){var t=[];if(e||!m.arraysEqual(this.previousSimulationParams,t)){this.previousSimulationParams=t,this.state.infectedPerDay.length>1&&null!==this.state.infectedPerDay[this.state.infectedPerDay.length-2]&&(this.state.capacityPerDay.push(null),this.state.deadPerDay.push(null),this.state.infectedPerDay.push(null),this.state.recoveredPerDay.push(null)),0!==this.state.infectedPerDay.length&&null!==this.state.infectedPerDay[this.state.infectedPerDay.length-1]||(this.state.capacityPerDay.push(this.state.hospitalCapacityPct*this.props.gridRows*this.props.gridRows),this.state.deadPerDay.push(0),this.state.infectedPerDay.push(this.props.nug),this.state.recoveredPerDay.push(0)),this.state.centerNodeNeighborsToDisplay=[];var a=this.props.gridRows,i=this.props.gridCols;this.grid=[];for(var s=0;s<a;s++){for(var r=[],n=0;n<i;n++){var o=new b(this.rng,s,n);Math.random()<this.state.immunityFraction&&(o.setInQuarentine(),o.quarentine=!0),r.push(o)}this.grid.push(r)}var l=new Set;if(this.props.addLinkedNodes)for(var h=0;h<3;h++)for(var c=0;c<3;c++){var u=Math.floor(a/6*(2*h+1)),d=Math.floor(i/6*(2*c+1)),p=this.grid[u][d];p.linked=!0,p.setSusceptible(),l.add(p)}if(this.props.addCities){var f=[];f.push([Math.floor(.75*a),Math.floor(.25*i)]),f.push([Math.floor(.25*a),Math.floor(.75*i)]);for(var v=0;v<a;v++)for(var y=0;y<i;y++)for(var g=0;g<f.length;g++){var E=f[g],S=E[0],D=E[1],w=Math.sqrt(Math.pow(S-v,2)+Math.pow(D-y,2));w<=16&&(this.grid[v][y].specialDegree=8-Math.floor(w/4))}}var k=Math.floor((a-1)/2),P=Math.floor((i-1)/2);if(1===this.props.nug)0===this.state.daysIncubating?this.grid[k][P].setInfected():this.grid[k][P].setExposed();else if(5===this.props.nug)for(var O=-1;O<=1;O++)for(var C=-1;C<=1;C++)1===Math.abs(O)&&1===Math.abs(C)||this.grid[k+O][P+C].setExposed();else if(20===this.props.nug)for(var I=-2;I<=2;I++)for(var R=-2;R<=2;R++)2===Math.abs(I)&&2===Math.abs(R)||this.grid[k+I][P+R].setExposed();this.redraw(!0),this.setState({numActiveNodes:this.props.nug})}}},{key:"simulateStep",value:function(){for(var e=this.props.gridRows,t=this.props.gridCols,a=new Set,i=0;i<e;i++)for(var s=0;s<t;s++){var r=this.grid[i][s];r.startDay(),this.state.longDistaceNetworkActive&&r.linked&&a.add(r)}for(var n=[],o=0;o<e;o++)for(var l=0;l<t;l++){var h=this.grid[o][l];this.props.showInteractions&&this.isCenterNode(o,l)&&h.canInfectOthers()?n=this.maybeInfect(h,o,l,a):this.maybeInfect(h,o,l,a)}for(var c=0,u=0;u<e;u++)for(var p=0;p<t;p++){var f=this.grid[u][p];f.getNextState()!==w.EXPOSED&&f.getNextState()!==w.INFECTED||c++}var v=this.state.chanceOfIsolationAfterSymptoms;this.props.showChanceOfIsolationAfterSymptomsSlider||(v=0);for(var y=this.state.hospitalCapacityPct>-1&&c>this.state.hospitalCapacityPct*(e*t),m=0;m<e;m++)for(var g=0;g<t;g++){this.grid[m][g].endDay(y,this.state.daysIncubating,this.state.daysSymptomatic,this.props.showDeaths,this.state.deathRate,v)}for(var E=0,S=0,D=0;D<e;D++)for(var b=0;b<t;b++){var k=this.grid[D][b];k.getNextState()===w.REMOVED?S++:k.getNextState()===w.DEAD&&E++}this.state.capacityPerDay.push(this.state.hospitalCapacityPct*this.props.gridRows*this.props.gridRows),this.state.deadPerDay.push(E),this.state.infectedPerDay.push(c),this.state.recoveredPerDay.push(S),this.state.centerNodeNeighborsToDisplay=n;for(var P=[],O=0;O<6;O++)for(var C=0;C<6;C++){for(var I=Object(d.a)(new Array(6)).map(function(){return 0}),R=0;R<10;R++)for(var N=0;N<10;N++){var x=10*O+R,A=10*C+N,T=this.grid[x][A];T.getNextState()===w.SUSCEPTIBLE?I[w.SUSCEPTIBLE]++:T.getNextState()===w.QUARENTINE?I[w.QUARENTINE]++:T.getNextState()===w.EXPOSED?I[w.EXPOSED]++:T.getNextState()===w.INFECTED?I[w.INFECTED]++:T.getNextState()===w.REMOVED?I[w.REMOVED]++:T.getNextState()===w.DEAD&&I[w.DEAD]++}P.push(I)}if(this.updateOscillators(P),0===c){this.generate(!0),this.forceUpdate(),this.resetPlotVariables(),this.frequencies=[];for(var M=w.DEAD+1,L=0;L<M;L++)this.frequencies.push(1800*Math.random()+200)}this.frequencies=this.frequencies.sort(function(e,t){return e-t}),this.setState({numActiveNodes:c}),this.redraw(!0)}},{key:"isCenterNode",value:function(e,t){return e===t&&e===Math.floor(this.props.gridRows/2)}},{key:"maybeInfect",value:function(e,t,a,i){var s=[];if((e.canInfectOthers()||this.isCenterNode(t,a))&&(s=this.getNeighbors(e,t,a,i)),e.canInfectOthers()){var r=this.state.transmissionProbability;r=Math.pow(r,3);var n=!0,o=!1,l=void 0;try{for(var h,c=s[Symbol.iterator]();!(n=(h=c.next()).done);n=!0){var u=h.value;e.tryToInfect(u,r)}}catch(d){o=!0,l=d}finally{try{n||null==c.return||c.return()}finally{if(o)throw l}}}return s}},{key:"chooseRandomNeighbor",value:function(e,t,a){for(var i=this.state.travelRadius,s=null;null===s;){var r=Math.floor(Math.random()*(2*i)-i),n=Math.floor(Math.random()*(2*i)-i);if((0!==r||0!==n)&&(1!==i||1!==Math.abs(r)||1!==Math.abs(n))){var o=t+r,l=a+n;o<0||o>=this.grid.length||l<0||l>=this.grid[0].length||(s=this.grid[o][l])}}return s}},{key:"updateOscillators",value:function(e){for(var t=[],a=[],i=[],s=0;s<e.length;s++){var r=e[s],n=r.indexOf(Math.max.apply(Math,Object(d.a)(r)));Math.random()>r[n]/100?t.push(this.oscillatorType[n]):t.push(this.oscillatorType[0]),i.push(r[n]/100);for(var o=0,l=0;l<r.length;l++)o+=r[l]*this.frequencies[l];a.push(o/100)}console.log(a),this.oscillators.setOscType(t),this.oscillators.setFrequency(a,20*this.state.speed/1e3),this.oscillators.setOscGain(i)}},{key:"getNeighbors",value:function(e,t,a,i){var s=[],r=this.state.personHours;if(e.isIsolating()&&(r*=1-this.state.decreaseInEncountersAfterSymptoms),0===this.state.travelRadius);else if(1===this.state.travelRadius&&4===r)t>0&&s.push(this.grid[t-1][a]),a>0&&s.push(this.grid[t][a-1]),t<this.grid.length-1&&s.push(this.grid[t+1][a]),a<this.grid[0].length-1&&s.push(this.grid[t][a+1]);else for(;s.length<r;){var n=this.chooseRandomNeighbor(e,t,a);s.push(n)}return s}},{key:"togglePlayback",value:function(){0===this.state.numActiveNodes&&(this.generate(!0),console.log("restarting")),this.state.playing?this.oscillators.stop():this.state.playing||this.oscillators.start(),this.setState({playing:!this.state.playing})}},{key:"inInitialPosition",value:function(){return 0===this.state.infectedPerDay.length}},{key:"redraw",value:function(e){if(null!==this.canvas&&void 0!==this.canvas){var t=[this.state.drawNodeOutlines,this.state.longDistaceNetworkActive,this.state.personHours,this.state.travelRadius];if(e||!m.arraysEqual(this.previousDrawingParams,t)){this.previousDrawingParams=t;var a=[this.state.personHours,this.state.travelRadius],i=!m.arraysEqual(this.previousInteractionsParams,a);this.previousInteractionsParams=a;var s=this.canvas.getContext("2d");s.fillStyle="#EEE",s.fillRect(0,0,this.gridWidth,this.gridWidth);for(var r=0;r<this.grid.length;r++)for(var n=0;n<this.grid[r].length;n++){var o=this.grid[r][n];this.drawCell(r,n,o,s,!1)}if(this.props.showInteractions&&(i||this.inInitialPosition())){var l=Math.floor(this.props.gridRows/2),h=l,c=this.grid[l][h],u=this.getNeighbors(c,l,h,null),d=!0,p=!1,f=void 0;try{for(var v,y=u[Symbol.iterator]();!(d=(v=y.next()).done);d=!0){var g=v.value;this.drawCell(g.r,g.c,g,s,!0)}}catch(P){p=!0,f=P}finally{try{d||null==y.return||y.return()}finally{if(p)throw f}}var E=!0,S=!1,D=void 0;try{for(var w,b=u[Symbol.iterator]();!(E=(w=b.next()).done);E=!0){var k=w.value;this.drawInteraction(l,h,k.r,k.c,s)}}catch(P){S=!0,D=P}finally{try{E||null==b.return||b.return()}finally{if(S)throw D}}}}}else console.log("no canvas")}},{key:"drawInteraction",value:function(e,t,a,i,s){var r=this.nodeSize;s.strokeStyle="#000",s.beginPath(),s.moveTo((t+.5)*r,(e+.5)*r),s.lineTo((i+.5)*r,(a+.5)*r),s.stroke()}},{key:"drawCell",value:function(e,a,i,s,r){var n=this.nodeSize,o=e*n,l=a*n;if(i.isExposed())s.fillStyle=w.EXPOSED_COLOR;else if(i.isInfected())i.isIsolating()?s.fillStyle=w.ISOLATING_COLOR:s.fillStyle=w.INFECTED_COLOR;else if(i.isRemoved())s.fillStyle=w.REMOVED_COLOR;else if(i.isDead())s.fillStyle=w.DEAD_COLOR;else if(i.isInQuarentine())s.fillStyle=w.QUARENTINE_COLOR;else if(s.fillStyle=w.SUSCEPTIBLE_COLOR,null!==i.specialDegree){m.assert(i.specialDegree>=4&&i.specialDegree<=8,"node.specialDegree should be between 4 and 8; was: "+i.specialDegree);var h=(i.specialDegree-4)/4;s.fillStyle=y.hex(y.blend(y.makeHex(t.SUSCEPTIBLE_COLOR),y.makeHex("#BBB"),h))}if(s.fillRect(l,o,n-1,n-1),i.isInQuarentine()&&(s.strokeStyle=w.QUARENTINE_STROKE,s.strokeRect(l,o,n-1,n-1)),r||i.linked&&this.state.longDistaceNetworkActive){s.lineWidth=1,s.strokeStyle="#000";var c=l-.5,u=n-1+1;0===l&&(c=.5,u-=1);var d=o-.5,p=n-1+1;0===o&&(d=.5,p-=1),s.strokeRect(c,d,u,p)}}},{key:"renderSlider",value:function(e,a,i,r,n,o,l,h){var c;c=0===l?"":l?s.a.createElement("span",null,"\xa0\xa0\xa0\xa0\xa0",t.renderPercentage(a)):s.a.createElement("span",null,"\xa0\xa0\xa0\xa0\xa0",s.a.createElement("strong",null,Math.round(100*a)/100));return h&&" highlighted",s.a.createElement("div",{className:"slider-container"},s.a.createElement("div",{className:"slider-name"},e,c),s.a.createElement("div",{className:"slider-slider"},s.a.createElement(E.a,{classes:{container:"slider-slider-container",thumbIconWrapper:""},min:r,max:n,step:o,value:a,onChange:i})))}},{key:"render",value:function(){var e=this;this.generate(),this.redraw();var t=this.props.showAllControls,a=null;(t||this.props.showTransmissionProbabilitySlider)&&(a=this.renderSlider("Transmission rate",this.state.transmissionProbability,function(t,a){e.setState({transmissionProbability:a})},0,this.props.maxTransmissionRate,.01,!1,"transmissionRate"===this.props.highlight));var i=null;if(t||this.props.showImmunityFractionSlider){var r=this.props.immunitySliderName||"Immunity";i=this.renderSlider(r,this.state.immunityFraction,function(t,a){e.setState({immunityFraction:a})},0,1,.01,!0,"immunity"===this.props.highlight)}(t||this.props.showHospitalCapacitySlider)&&this.renderSlider("Hospital capacity",this.state.hospitalCapacityPct,function(t,a){e.setState({hospitalCapacityPct:a})},0,1,.01,!0,!1);var n=null;(t||this.props.showTravelRadiusSlider)&&(n=this.renderSlider("Travel radius",this.state.travelRadius,function(t,a){e.setState({travelRadius:a})},0,Math.min(30,Math.floor(this.props.gridRows/2)),1,!1,!1));(t||this.props.showPersonHoursSlider)&&this.renderSlider("Encounters per day",this.state.personHours,function(t,a){e.setState({personHours:a})},1,30,1,!1,!1);(t||this.props.showDaysPerStateControls)&&this.renderSlider("Days in incubation",this.state.daysIncubating,function(t,a){e.setState({daysIncubating:a})},0,20,1,!1,!1);(t||this.props.showDaysPerStateControls)&&this.renderSlider("Days with symptoms",this.state.daysSymptomatic,function(t,a){e.setState({daysSymptomatic:a})},1,20,1,!1,!1);var o=null;(t||this.props.showChanceOfIsolationAfterSymptomsSlider)&&(o=this.renderSlider("Self-quarantine rate",this.state.chanceOfIsolationAfterSymptoms,function(t,a){e.setState({chanceOfIsolationAfterSymptoms:a})},0,1,.01,!0,!1));var l=null;(t||this.props.showDecreaseInEncountersAfterSymptomsSlider)&&(l=this.renderSlider("Self-quarantine strictness",this.state.decreaseInEncountersAfterSymptoms,function(t,a){e.setState({decreaseInEncountersAfterSymptoms:a})},0,1,.01,!0,!1));if(t||this.props.showDeathRateSlider){var h="Fatality rate";this.state.hospitalCapacityPct>-1&&(h="Input fatality rate"),this.renderSlider(h,this.state.deathRate,function(t,a){e.setState({deathRate:a})},0,.3,.01,!0,!1)}var c=null;(t||this.props.showSpeedControls)&&(s.a.createElement(N,{onClick:function(){e.setState({speed:Math.max(0,e.state.speed-.2)})}},"\ud83d\udeb6"),s.a.createElement(N,{onClick:function(){e.setState({speed:Math.min(1,e.state.speed+.2)})}},"\ud83c\udfc3"),c=this.renderSlider("Speed",this.state.speed,function(t,a){e.setState({speed:a})},1e-4,1,1e-5,0,!1));var u=null;if(t||this.props.showPlaybackControls){var d=s.a.createElement(N,{onClick:function(){e.setState({playing:!1}),e.generate(!0),e.forceUpdate(),e.resetPlotVariables(),e.oscillators.stop()}},"Reset"),p=s.a.createElement("span",{style:{fontSize:"10pt"}},"\u25b7");this.state.playing&&(p=s.a.createElement("span",null,s.a.createElement("b",null,"||")));var f=s.a.createElement(N,{highlighted:!this.state.playing,onClick:function(){e.togglePlayback()}},p),v=s.a.createElement(N,{onClick:function(){e.simulateStep(),e.setState({playing:!1})}},"Step");u=s.a.createElement("div",{className:"playback-controls-container"},d,f,v)}if(this.props.addLinkedNodes){var y="Long distance: disabled";this.state.longDistaceNetworkActive&&(y="Long distance: enabled"),s.a.createElement("div",null,s.a.createElement("span",{onClick:function(){e.setState({longDistaceNetworkActive:!e.state.longDistaceNetworkActive})}},y))}this.props.showProTip&&s.a.createElement("div",{style:{color:"#666",fontSize:"12pt",marginTop:"1em"}},"\ud83d\udc46 Pro-tip: You can adjust sliders while the simulation is running.");var m=50*this.state.speed,g=null;"transmissionRate"===this.props.highlight?(g=a,a=null):"immunity"===this.props.highlight&&(g=i,i=null);var E=null;if(this.props.showAliveFraction){var S=this.props.gridRows*this.props.gridRows;E=s.a.createElement(A,{hospitalCapacity:this.state.hospitalCapacityPct*S,capacityPerDay:this.state.capacityPerDay,deadPerDay:this.state.deadPerDay,infectedPerDay:this.state.infectedPerDay,population:S,recoveredPerDay:this.state.recoveredPerDay,showDeaths:this.props.showDeaths})}return s.a.createElement("div",{className:"simulation-container"},s.a.createElement("div",{className:"automata"},s.a.createElement(k.a,{onEnter:this.onEnter,onLeave:this.onLeave,scrollableAncestor:window},s.a.createElement("canvas",{ref:this.canvasRef,width:this.gridWidth,height:this.gridWidth})),null),s.a.createElement("div",{className:"controls"},s.a.createElement("div",{style:{height:"0.5em"}}),g,o,l,n,a,i,c,u),s.a.createElement("div",{className:"curve"},E),s.a.createElement("div",{className:"audio"}),s.a.createElement("div",{className:"blankboxl"},s.a.createElement("span",{className:"legend-text"},"Infected \xa0",s.a.createElement(x,{type:"infected"})),s.a.createElement("span",{className:"legend-text"},"Recovered \xa0",s.a.createElement(x,{type:"removed"})),s.a.createElement("span",{className:"legend-text"},"Dead \xa0",s.a.createElement(x,{type:"dead"}))),s.a.createElement("div",{className:"blankboxr"}),s.a.createElement(D,{milliseconds:m,callback:this.onTick}))}}],[{key:"shuffleInPlace",value:function(e,t){for(var a=e.length-1;a>0;a--){var i=Math.floor(t.random()*(a+1)),s=[e[i],e[a]];e[a]=s[0],e[i]=s[1]}return e}},{key:"renderPercentage",value:function(e){var t=Math.round(100*e);return s.a.createElement("span",null,s.a.createElement("strong",null,t),"%")}}]),t}(i.Component);L.NEIGHBOR_CLASSES=[[[0,0]],[[-1,0],[1,0],[0,-1],[0,1]],[[-1,-1],[-1,1],[1,-1],[1,1]],[[-2,-2],[-2,-1],[-2,0],[-2,1],[-2,2],[-1,2],[0,2],[1,2],[2,2],[2,1],[2,0],[2,-1],[2,-2],[1,-2],[0,-2],[-1,-2]]],L.defaultProps={randomSeed:-1,addCities:!1,addLinkedNodes:!1,gridCols:1,gridRows:1,daysIncubating:5,daysSymptomatic:14,deathRate:.032,decreaseInEncountersAfterSymptoms:.25,chanceOfIsolationAfterSymptoms:.25,hospitalCapacityPct:-1,immunityFraction:.1,maxIterations:-1,nug:20,personHours:5,transmissionProbability:.185,travelRadius:5,drawNodeOutlines:!0,speed:.5,immunitySliderName:"Immunity",maxTransmissionRate:1,showAliveFraction:!1,showAllControls:!1,showDaysPerStateControls:!1,showDeaths:!1,showDecreaseInEncountersAfterSymptomsSlider:!1,showChanceOfIsolationAfterSymptomsSlider:!1,showDeathRateSlider:!1,showDegreeSlider:!1,showHospitalCapacitySlider:!1,showImmunityFractionSlider:!1,showInteractions:!1,showPersonHoursSlider:!1,showPlaybackControls:!0,showProTip:!1,showSimulationButtons:!1,showSpeedControls:!1,showTransmissionProbabilitySlider:!1,showTravelRadiusSlider:!1};var j=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(h.a)(this,Object(c.a)(t).call(this,e))).state={spoilersVisible:!1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"renderMainPost",value:function(){s.a.createElement("code",{className:"code-exposed"},"you"),s.a.createElement("code",{className:"code-susceptible"},"Susceptible"),s.a.createElement("code",{className:"code-infectious"},"Infected"),s.a.createElement("code",{className:"code-removed"},"Recovered"),s.a.createElement("code",{className:"code-dead"},"Dead"),s.a.createElement("code",{className:"code-quarantined"},"Self-quarantined");return s.a.createElement("div",{className:"main-container"},s.a.createElement(L,{gridRows:60,gridCols:60,hospitalCapacityPct:.05,nodeSize:9,nug:5,randomSeed:100,showAliveFraction:!0,showAllControls:!0,showDaysPerStateControls:!1,showDeaths:!0,showTransmissionProbabilitySlider:!0,showChanceOfIsolationAfterSymptomsSlider:!0,speed:1,immunityFraction:.1}))}},{key:"render",value:function(){return s.a.createElement("div",{className:"root-container"},s.a.createElement("div",{style:{height:"5em"}}),this.renderMainPost())}}]),t}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(s.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},45:function(e,t,a){},68:function(e,t,a){e.exports=a(180)},73:function(e,t,a){}},[[68,2,1]]]);
//# sourceMappingURL=main.d8334950.chunk.js.map