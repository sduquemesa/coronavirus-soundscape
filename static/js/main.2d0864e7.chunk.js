(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{180:function(t,e,a){"use strict";a.r(e);var i=a(0),s=a.n(i),r=a(21),n=a.n(r),o=(a(73),a(3)),l=a(4),h=a(9),c=a(8),u=a(10),d=(a(45),a(43)),p=a(6),f=a(31),v=a.n(f),y=function(){function t(){Object(o.a)(this,t)}return Object(l.a)(t,null,[{key:"makeHex",value:function(t){var e=v()(t);return[e.red(),e.green(),e.blue()]}},{key:"makeRGB",value:function(t,e,a){return[t,e,a]}},{key:"makeHSL",value:function(t,e,a){var i=v.a.hsl(t,e,a);return[i.red(),i.green(),i.blue()]}},{key:"blend",value:function(t,e,a){return[(e[0]-t[0])*a+t[0],(e[1]-t[1])*a+t[1],(e[2]-t[2])*a+t[2]]}},{key:"withAlpha",value:function(t,e){return[t[0],t[1],t[2],e]}},{key:"r",value:function(t){return t[0]}},{key:"g",value:function(t){return t[1]}},{key:"b",value:function(t){return t[2]}},{key:"a",value:function(t){return 4===t.length?t[3]:255}},{key:"hue",value:function(t){var e=t[0]/255,a=t[1]/255,i=t[2]/255,s=Math.min(e,a,i),r=Math.max(e,a,i),n=NaN,o=r-s,l=(r+s)/2;return o?(n=e===r?(a-i)/o+6*(a<i):a===r?(i-e)/o+2:(e-a)/o+4,o/=l<.5?r+s:2-r-s,n*=60):o=l>0&&l<1?0:n,n}},{key:"__helperRep",value:function(e){return v.a.rgb(t.r(e),t.g(e),t.b(e),t.a(e))}},{key:"__fromHelperRep",value:function(t){return[t.red(),t.green(),t.blue()]}},{key:"hex",value:function(e){return t.__helperRep(e).toString()}},{key:"opacity",value:function(e){return t.a(e)/255}},{key:"lighten",value:function(e,a){return t.__fromHelperRep(t.__helperRep(e).whiten(a))}}]),t}(),m=function(){function t(){Object(o.a)(this,t)}return Object(l.a)(t,null,[{key:"assert",value:function(t,e){t||(console.log("ACK!",e),alert("ACK! "+e))}},{key:"makeImageUri",value:function(t){var e=-1,a=!0,i=!1,s=void 0;try{for(var r,n=t[Symbol.iterator]();!(a=(r=n.next()).done);a=!0){var o=r.value;o.length>e&&(e=o.length)}}catch(P){i=!0,s=P}finally{try{a||null==n.return||n.return()}finally{if(i)throw s}}for(var l=t.length,h=new Uint8ClampedArray(e*l*4),c=0;c<l;c++){for(var u=t[c].length,d=Math.floor((e-u)/2),p=e-u-d,f=0;f<u;f++){var v=t[c][f],m=4*(c*e+d+f);h[m]=y.r(v),h[m+1]=y.g(v),h[m+2]=y.b(v),h[m+3]=y.a(v)}for(var g=0;g<d;g++){var E=4*(c*e+g);h[E]=255,h[E+1]=255,h[E+2]=255,h[E+3]=255}for(var S=u+p;S<e;S++){var D=4*(c*e+S);h[D]=255,h[D+1]=255,h[D+2]=255,h[D+3]=255}}var w=document.createElement("canvas"),b=w.getContext("2d");w.width=e,w.height=l;var k=b.createImageData(e,l);return k.data.set(h),b.putImageData(k,0,0),w.toDataURL()}},{key:"arraysEqual",value:function(e,a){if(e.length!==a.length)return!1;for(var i=0;i<e.length;i++){var s=e[i],r=a[i],n=s===r;if(Array.isArray(s)&&Array.isArray(r)&&(n=t.arraysEqual(s,r)),!n)return!1}return!0}}]),t}(),g=a(67),E=a.n(g),S=function(){function t(e){Object(o.a)(this,t),null!==e&&void 0!==e||(e=Math.floor(Math.random()*t.m)),this.lastX=Math.floor(e)}return Object(l.a)(t,[{key:"random",value:function(){return this.lastX=(t.a*this.lastX+t.c)%t.m,this.lastX/t.m}},{key:"randBetween",value:function(t,e){return this.random()*(e-t)+t}},{key:"randIntBetween",value:function(t,e){var a=this.random()*(e-t+1);return Math.floor(a)+t}}]),t}();S.m=2147483648,S.a=214013,S.c=2531011;var D=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(h.a)(this,Object(c.a)(e).call(this,t))).initializeFromProps(a.props,!0),a}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentWillReceiveProps",value:function(t,e){this.initializeFromProps(t,!1)}},{key:"initializeFromProps",value:function(t,e){var a={};e?this.state=a:this.setState(a),null!==this.interval&&void 0!==this.interval&&clearInterval(this.interval),this.interval=setInterval(t.callback,t.milliseconds)}},{key:"render",value:function(){return null}}]),e}(i.Component);D.defaultProps={};var w=function t(){Object(o.a)(this,t)};w.SUSCEPTIBLE_COLOR="#EEE",w.EXPOSED_COLOR="#ffdde2",w.INFECTED_COLOR="#F44",w.ISOLATING_COLOR="#8094ff",w.REMOVED_COLOR="#999",w.DEAD_COLOR="#000",w.QUARENTINE_COLOR="#e1e7f0",w.QUARENTINE_STROKE="#a3aab5",w.SUSCEPTIBLE=0,w.QUARENTINE=1,w.EXPOSED=2,w.INFECTED=3,w.REMOVED=4,w.DEAD=5;var b=function(){function t(e,a,i){Object(o.a)(this,t),this.r=a,this.c=i,this.state=w.SUSCEPTIBLE,this.nextState=w.SUSCEPTIBLE,this.daysInState=0,this.linked=!1,this.mediaOutlet=!1,this.specialDegree=null,this.dead=!1,this.isolating=!1,this.quarentine=!1,this.rng=e}return Object(l.a)(t,[{key:"getState",value:function(){return this.state}},{key:"getNextState",value:function(){return this.nextState}},{key:"isSusceptible",value:function(){return this.state===w.SUSCEPTIBLE}},{key:"isExposed",value:function(){return this.state===w.EXPOSED}},{key:"isInfected",value:function(){return this.state===w.INFECTED}},{key:"canInfectOthers",value:function(){return this.state===w.EXPOSED||this.state===w.INFECTED}},{key:"isRemoved",value:function(){return this.state===w.REMOVED}},{key:"isDead",value:function(){return this.state===w.DEAD}},{key:"isAllowedToBeRemoved",value:function(){return!this.linked}},{key:"_setState",value:function(t){this.state=t}},{key:"setNextState",value:function(t){this.nextState=t}},{key:"setSusceptible",value:function(){this._setState(w.SUSCEPTIBLE)}},{key:"setExposed",value:function(){this._setState(w.EXPOSED)}},{key:"setInfected",value:function(){this._setState(w.INFECTED)}},{key:"setRemoved",value:function(){this._setState(w.REMOVED)}},{key:"setDead",value:function(){this._setState(w.DEAD)}},{key:"startDay",value:function(){this.nextState=this.state}},{key:"setInQuarentine",value:function(){this._setState(w.QUARENTINE)}},{key:"isIsolating",value:function(){return this.isolating}},{key:"isInQuarentine",value:function(){return this.quarentine}},{key:"tryToInfect",value:function(t,e){if(t.isSusceptible()&&this.rng.random()<e){t.setNextState(w.EXPOSED)}}},{key:"maybeIsolate",value:function(t){this.rng.random()<t&&(this.isolating=!0)}},{key:"endDay",value:function(t,e,a,i,s,r){this.nextState!==this.state?(this.nextState===w.EXPOSED&&0===e&&(this.nextState=w.INFECTED,this.maybeIsolate(r)),this._setState(this.nextState),this.daysInState=0):(this.daysInState++,this.isExposed()?this.daysInState>=e&&(this.setInfected(),this.maybeIsolate(r),this.daysInState=0):this.isInfected()&&this.daysInState>=a&&(t&&(s*=2),i||(s=0),this.rng.random()<s?this.setDead():this.setRemoved(),this.daysInState=0))}}]),t}(),k=a(64),P=a(66),O=a.n(P),C=a(182),I=Object(C.withStyles)({root:{background:"linear-gradient(0deg, #f0f0f0 30%, #f8f8f8 90%)"},label:{textTransform:"capitalize"}})(O.a),R=Object(C.withStyles)({root:{background:"linear-gradient(0deg, #ccddff 30%, #ddeeff 90%)"},label:{textTransform:"capitalize"}})(I),N=function(t){function e(){return Object(o.a)(this,e),Object(h.a)(this,Object(c.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e={margin:"0.5rem"};return"small"===this.props.size&&(e={margin:"0.5rem",maxWidth:"30px",maxHeight:"30px",minWidth:"30px",minHeight:"30px"}),this.props.highlighted?s.a.createElement(R,{variant:"contained",onClick:function(e){e.preventDefault(),t.props.onClick(e)},style:e},this.props.children):s.a.createElement(I,{variant:"contained",onClick:function(e){e.preventDefault(),t.props.onClick(e)},style:e},this.props.children)}}]),e}(s.a.PureComponent),x=function(t){function e(){return Object(o.a)(this,e),Object(h.a)(this,Object(c.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=w.SUSCEPTIBLE_COLOR;return"exposed"===this.props.type?t=w.EXPOSED_COLOR:"infected"===this.props.type?t=w.INFECTED_COLOR:"removed"===this.props.type?t=w.REMOVED_COLOR:"dead"===this.props.type&&(t=w.DEAD_COLOR),s.a.createElement("div",{style:{marginBottom:"-2px",border:"1px black solid",width:"1rem",height:"1rem",backgroundColor:t,display:"inline-block"}})}}]),e}(i.Component),A=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(h.a)(this,Object(c.a)(e).call(this,t))).width=null,a.height=150,a.canvasRef=s.a.createRef(),a.state={showDead:!0,showInfected:!0,showRecovered:!0},a.componentWillReceiveProps(t),a.updateWindowDimensions=a.updateWindowDimensions.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(e,t),Object(l.a)(e,[{key:"updateWindowDimensions",value:function(){var t=Math.min(600,document.documentElement.clientWidth-60);this.width!==t&&(this.width=t,this.redraw())}},{key:"componentWillReceiveProps",value:function(t,e){this.updateMaxValues(t)}},{key:"updateMaxValues",value:function(t){this.maxValue=1;var e=[];this.state.showInfected&&e.push(t.infectedPerDay),this.state.showRecovered&&e.push(t.recoveredPerDay),this.state.showDead&&e.push(t.deadPerDay),t.hospitalCapacity>-1&&e.push(t.capacityPerDay);for(var a=0;a<t.infectedPerDay.length;a++)for(var i=0;i<e.length;i++){var s=e[i][a];null!==s&&s>this.maxValue&&(this.maxValue=s)}this.maxValue*=1.1,this.maxValue=this.props.population,this.maxDay=Math.max(t.infectedPerDay.length-1,1)}},{key:"componentDidMount",value:function(){this.canvas=this.canvasRef.current,this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),this.redraw()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"showHospitalCapacity",value:function(){return this.props.hospitalCapacity>-1}},{key:"redraw",value:function(){if(null!==this.canvas&&void 0!==this.canvas){this.updateMaxValues(this.props);var t=this.canvas.getContext("2d");t.fillStyle=w.SUSCEPTIBLE_COLOR,t.fillRect(0,0,this.width,this.height),t.setLineDash([]),t.lineWidth=2;for(var e=[],a=[],i=[],s=[],r=[],n=[],o=0;o<this.props.infectedPerDay.length;o++){var l=o,h=this.props.infectedPerDay[l],c=this.props.recoveredPerDay[l],u=this.props.deadPerDay[l],d=(this.props.population,this.props.capacityPerDay[l]);null===h?(this.drawPath(e,a,t,w.INFECTED_COLOR),this.drawPath(a,i,t,"#A8A8A8"),this.drawPath(i,s,t,w.DEAD_COLOR),this.showHospitalCapacity()&&this.drawPath(n,n,t,"#000"),e.length=0,a.length=0,i.length=0,s.length=0,r.length=0,n.length=0):(e.push([this.xcoord(l),this.ycoord(0)]),a.push([this.xcoord(l),this.ycoord(h)]),i.push([this.xcoord(l),this.ycoord(h+c)]),s.push([this.xcoord(l),this.ycoord(h+c+u)]),r.push([this.xcoord(l),this.ycoord(this.maxValue)]),n.push([this.xcoord(l),this.ycoord(d)]))}this.drawPath(e,a,t,w.INFECTED_COLOR),this.drawPath(a,i,t,"#A8A8A8"),this.drawPath(i,s,t,w.DEAD_COLOR),this.showHospitalCapacity()&&this.drawPath(n,n,t,"#000");for(var p=0;p<this.props.infectedPerDay.length;p++){var f=p;null===this.props.infectedPerDay[f]&&(t.strokeStyle="#000",t.lineWidth=2,t.setLineDash([5,5]),this.drawLine(t,f-1,0,f-1,this.maxValue))}t.strokeStyle="#000",t.setLineDash([]),t.lineWidth=1,this.drawLine(t,0,0,0,this.maxValue),this.drawLine(t,0,0,this.maxDay,0)}}},{key:"drawPath",value:function(t,e,a,i){if(0!==t.length){a.beginPath(),a.moveTo(t[0][0],t[0][1]);for(var s=0;s<t.length;s++)a.lineTo(t[s][0],t[s][1]);if(t!==e)for(var r=e.length-1;r>=0;r--)a.lineTo(e[r][0],e[r][1]);t===e?(a.strokeStyle=i,a.lineWidth=2,a.setLineDash([5,5]),a.stroke()):(a.fillStyle=i,a.fill())}}},{key:"drawSeries",value:function(t,e){for(var a=1;a<t.length;a++){var i=a-1,s=a,r=t[i],n=t[s];null!==r&&null!==n&&this.drawLine(e,i,r,s,n)}}},{key:"xcoord",value:function(t){return this.width*t/this.maxDay}},{key:"ycoord",value:function(t){return(this.height-1)*(1-t/this.maxValue)}},{key:"drawBar",value:function(t,e,a,i,s){var r=this.xcoord(e),n=this.xcoord(i),o=this.ycoord(a),l=this.ycoord(s);t.fillRect(r,o,n-r,l-o)}},{key:"drawLine",value:function(t,e,a,i,s){t.beginPath(),t.moveTo(this.xcoord(e),this.ycoord(a)),t.lineTo(this.xcoord(i),this.ycoord(s)),t.stroke()}},{key:"resetArrays",value:function(){this.props.capacityPerDay.length=0,this.props.deadPerDay.length=0,this.props.infectedPerDay.length=0,this.props.recoveredPerDay.length=0,this.redraw(),this.forceUpdate()}},{key:"render",value:function(){this.redraw();var t=Math.round(this.props.infectedPerDay[this.props.infectedPerDay.length-1]/this.props.population*100),e=Math.round(this.props.recoveredPerDay[this.props.recoveredPerDay.length-1]/this.props.population*100),a=Math.round(this.props.deadPerDay[this.props.deadPerDay.length-1]/this.props.population*100);isNaN(t)&&(t=0),isNaN(e)&&(e=0),isNaN(a)&&(a=0);s.a.createElement("span",null,s.a.createElement(x,{type:"infected"})," \xa0Infected: ",t,"%"),s.a.createElement("span",null,s.a.createElement(x,{type:"removed"})," \xa0Recovered: ",e,"%");this.props.showDeaths&&s.a.createElement("span",null,s.a.createElement(x,{type:"dead"})," ",s.a.createElement("span",{style:{backgroundColor:"#FFA"}},"\xa0Dead: ",a,"%\xa0"));var i=this.width;return null===i&&(i=300),s.a.createElement("div",null,s.a.createElement("div",{className:"plot-container"},s.a.createElement("div",{className:"plot-chart"},s.a.createElement("canvas",{className:"canvas",ref:this.canvasRef,width:i,height:this.height})),s.a.createElement("div",{className:"plot-xaxis"},"time \u27f6")))}}]),e}(i.Component),T=a(22),M=function(){function t(e){var a=this;Object(o.a)(this,t),this.oscillators=[];for(var i=0;i<e;i++){var s=new T.Oscillator;this.oscillators.push(s)}this.oscillatorsGain=[];for(var r=0;r<e;r++){var n=new T.Gain;this.oscillatorsGain.push(n)}this.masterGain=new T.Gain,this.oscillators.map(function(t,e){a.oscillators[e].connect(a.oscillatorsGain[e]),a.oscillatorsGain[e].connect(a.masterGain),a.oscillatorsGain[e].gain.value=.2}),this.masterGain.gain.value=1/this.oscillators.length}return Object(l.a)(t,[{key:"connect",value:function(){this.masterGain.connect(T.Master)}},{key:"disconnect",value:function(){this.masterGain.disconnect()}},{key:"start",value:function(){this.oscillators.forEach(function(t){return t.start()})}},{key:"stop",value:function(){this.oscillators.forEach(function(t){return t.stop()})}},{key:"setFrequency",value:function(t,e){this.oscillators.forEach(function(a,i){Math.random()<.01?a.frequency.exponentialRampToValueAtTime(t[i],"+"+e.toString()):a.frequency.value=t[i]})}},{key:"setOscType",value:function(t){this.oscillators.forEach(function(e,a){e.type=t[a]})}},{key:"setOscGain",value:function(t){this.oscillatorsGain.forEach(function(e,a){e.gain.value=t[a]})}}]),t}(),L=function(t){function e(t){var a;Object(o.a)(this,e),(a=Object(h.a)(this,Object(c.a)(e).call(this,t))).canvasRef=s.a.createRef(),a.previousSimulationParams=["foo"],a.previousDrawingParams=[],a.previousInteractionsParams=[],a.onTick=a.onTick.bind(Object(p.a)(Object(p.a)(a))),a.onEnter=a.onEnter.bind(Object(p.a)(Object(p.a)(a))),a.onLeave=a.onLeave.bind(Object(p.a)(Object(p.a)(a))),a.oscillators=new M(36),a.oscillators.connect(),a.initializeFromProps(a.props,!0),a.updateWindowDimensions=a.updateWindowDimensions.bind(Object(p.a)(Object(p.a)(a))),a.frequencies=[];for(var i=w.DEAD+1,r=0;r<i;r++)a.frequencies.push(1800*Math.random()+200);return a.frequencies=a.frequencies.sort(function(t,e){return t-e}),a.oscillatorType=["sine","sine","sine","sine2","sine2","triangle"],a}return Object(u.a)(e,t),Object(l.a)(e,[{key:"updateWindowDimensions",value:function(){var t=this.props.gridCols*this.props.nodeSize;this.props.nodeSize>=5&&(t+=this.props.gridCols);var e=Math.min(t,document.documentElement.clientWidth-40),a=Math.floor(e/this.props.gridCols);e=a*this.props.gridCols,this.gridWidth===e&&this.nodeSize===a||(this.gridWidth=e,this.nodeSize=a,this.redraw(!0))}},{key:"componentWillReceiveProps",value:function(t,e){}},{key:"initializeFromProps",value:function(t,e){this.gridWidth=t.gridCols*t.nodeSize,this.nodeSize=t.nodeSize;var a=t.randomSeed;-1===a&&(a=Math.floor(3e6*Math.random())),this.rng=new S(a);var i={numActiveNodes:0,playing:!1,visible:!1,daysIncubating:t.daysIncubating,daysSymptomatic:t.daysSymptomatic,deathRate:t.deathRate,decreaseInEncountersAfterSymptoms:t.decreaseInEncountersAfterSymptoms,chanceOfIsolationAfterSymptoms:t.chanceOfIsolationAfterSymptoms,hospitalCapacityPct:t.hospitalCapacityPct,immunityFraction:t.immunityFraction,longDistaceNetworkActive:t.addLinkedNodes,maxIterations:t.maxIterations,personHours:t.personHours,transmissionProbability:t.transmissionProbability,travelRadius:t.travelRadius,centerNodeNeighborsToDisplay:[],drawNodeOutlines:t.drawNodeOutlines,hospitalCapacitySliderHighlighted:!1,speed:t.speed,capacityPerDay:[],deadPerDay:[],infectedPerDay:[],recoveredPerDay:[]};e?this.state=i:this.setState(i)}},{key:"componentDidMount",value:function(){this.canvas=this.canvasRef.current,this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),this.redraw(!0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"onTick",value:function(){this.state.playing&&this.state.visible&&(this.simulateStep(),this.redraw(!0))}},{key:"onEnter",value:function(){this.setState({visible:!0}),this.redraw(!0)}},{key:"onLeave",value:function(){this.setState({visible:!1})}},{key:"regenerate",value:function(){this.generate(),this.forceUpdate()}},{key:"resetPlotVariables",value:function(){this.state.capacityPerDay=[],this.state.deadPerDay=[],this.state.infectedPerDay=[],this.state.recoveredPerDay=[]}},{key:"generate",value:function(t){var e=[];if(t||!m.arraysEqual(this.previousSimulationParams,e)){this.previousSimulationParams=e,this.state.infectedPerDay.length>1&&null!==this.state.infectedPerDay[this.state.infectedPerDay.length-2]&&(this.state.capacityPerDay.push(null),this.state.deadPerDay.push(null),this.state.infectedPerDay.push(null),this.state.recoveredPerDay.push(null)),0!==this.state.infectedPerDay.length&&null!==this.state.infectedPerDay[this.state.infectedPerDay.length-1]||(this.state.capacityPerDay.push(this.state.hospitalCapacityPct*this.props.gridRows*this.props.gridRows),this.state.deadPerDay.push(0),this.state.infectedPerDay.push(this.props.nug),this.state.recoveredPerDay.push(0)),this.state.centerNodeNeighborsToDisplay=[];var a=this.props.gridRows,i=this.props.gridCols;this.grid=[];for(var s=0;s<a;s++){for(var r=[],n=0;n<i;n++){var o=new b(this.rng,s,n);Math.random()<this.state.immunityFraction&&(o.setInQuarentine(),o.quarentine=!0),r.push(o)}this.grid.push(r)}var l=new Set;if(this.props.addLinkedNodes)for(var h=0;h<3;h++)for(var c=0;c<3;c++){var u=Math.floor(a/6*(2*h+1)),d=Math.floor(i/6*(2*c+1)),p=this.grid[u][d];p.linked=!0,p.setSusceptible(),l.add(p)}if(this.props.addCities){var f=[];f.push([Math.floor(.75*a),Math.floor(.25*i)]),f.push([Math.floor(.25*a),Math.floor(.75*i)]);for(var v=0;v<a;v++)for(var y=0;y<i;y++)for(var g=0;g<f.length;g++){var E=f[g],S=E[0],D=E[1],w=Math.sqrt(Math.pow(S-v,2)+Math.pow(D-y,2));w<=16&&(this.grid[v][y].specialDegree=8-Math.floor(w/4))}}var k=Math.floor((a-1)/2),P=Math.floor((i-1)/2);if(1===this.props.nug)0===this.state.daysIncubating?this.grid[k][P].setInfected():this.grid[k][P].setExposed();else if(5===this.props.nug)for(var O=-1;O<=1;O++)for(var C=-1;C<=1;C++)1===Math.abs(O)&&1===Math.abs(C)||this.grid[k+O][P+C].setExposed();else if(20===this.props.nug)for(var I=-2;I<=2;I++)for(var R=-2;R<=2;R++)2===Math.abs(I)&&2===Math.abs(R)||this.grid[k+I][P+R].setExposed();this.redraw(!0),this.setState({numActiveNodes:this.props.nug})}}},{key:"simulateStep",value:function(){for(var t=this.props.gridRows,e=this.props.gridCols,a=new Set,i=0;i<t;i++)for(var s=0;s<e;s++){var r=this.grid[i][s];r.startDay(),this.state.longDistaceNetworkActive&&r.linked&&a.add(r)}for(var n=[],o=0;o<t;o++)for(var l=0;l<e;l++){var h=this.grid[o][l];this.props.showInteractions&&this.isCenterNode(o,l)&&h.canInfectOthers()?n=this.maybeInfect(h,o,l,a):this.maybeInfect(h,o,l,a)}for(var c=0,u=0;u<t;u++)for(var p=0;p<e;p++){var f=this.grid[u][p];f.getNextState()!==w.EXPOSED&&f.getNextState()!==w.INFECTED||c++}var v=this.state.chanceOfIsolationAfterSymptoms;this.props.showChanceOfIsolationAfterSymptomsSlider||(v=0);for(var y=this.state.hospitalCapacityPct>-1&&c>this.state.hospitalCapacityPct*(t*e),m=0;m<t;m++)for(var g=0;g<e;g++){this.grid[m][g].endDay(y,this.state.daysIncubating,this.state.daysSymptomatic,this.props.showDeaths,this.state.deathRate,v)}for(var E=0,S=0,D=0;D<t;D++)for(var b=0;b<e;b++){var k=this.grid[D][b];k.getNextState()===w.REMOVED?S++:k.getNextState()===w.DEAD&&E++}this.state.capacityPerDay.push(this.state.hospitalCapacityPct*this.props.gridRows*this.props.gridRows),this.state.deadPerDay.push(E),this.state.infectedPerDay.push(c),this.state.recoveredPerDay.push(S),this.state.centerNodeNeighborsToDisplay=n;for(var P=[],O=0;O<6;O++)for(var C=0;C<6;C++){for(var I=Object(d.a)(new Array(6)).map(function(){return 0}),R=0;R<10;R++)for(var N=0;N<10;N++){var x=10*O+R,A=10*C+N,T=this.grid[x][A];T.getNextState()===w.SUSCEPTIBLE?I[w.SUSCEPTIBLE]++:T.getNextState()===w.QUARENTINE?I[w.QUARENTINE]++:T.getNextState()===w.EXPOSED?I[w.EXPOSED]++:T.getNextState()===w.INFECTED?I[w.INFECTED]++:T.getNextState()===w.REMOVED?I[w.REMOVED]++:T.getNextState()===w.DEAD&&I[w.DEAD]++}P.push(I)}if(this.updateOscillators(P),0===c){this.generate(!0),this.forceUpdate(),this.resetPlotVariables(),this.frequencies=[];for(var M=w.DEAD+1,L=0;L<M;L++)this.frequencies.push(1800*Math.random()+200)}this.frequencies=this.frequencies.sort(function(t,e){return t-e}),this.setState({numActiveNodes:c}),this.redraw(!0)}},{key:"isCenterNode",value:function(t,e){return t===e&&t===Math.floor(this.props.gridRows/2)}},{key:"maybeInfect",value:function(t,e,a,i){var s=[];if((t.canInfectOthers()||this.isCenterNode(e,a))&&(s=this.getNeighbors(t,e,a,i)),t.canInfectOthers()){var r=this.state.transmissionProbability;r=Math.pow(r,3);var n=!0,o=!1,l=void 0;try{for(var h,c=s[Symbol.iterator]();!(n=(h=c.next()).done);n=!0){var u=h.value;t.tryToInfect(u,r)}}catch(d){o=!0,l=d}finally{try{n||null==c.return||c.return()}finally{if(o)throw l}}}return s}},{key:"chooseRandomNeighbor",value:function(t,e,a){for(var i=this.state.travelRadius,s=null;null===s;){var r=Math.floor(Math.random()*(2*i)-i),n=Math.floor(Math.random()*(2*i)-i);if((0!==r||0!==n)&&(1!==i||1!==Math.abs(r)||1!==Math.abs(n))){var o=e+r,l=a+n;o<0||o>=this.grid.length||l<0||l>=this.grid[0].length||(s=this.grid[o][l])}}return s}},{key:"updateOscillators",value:function(t){for(var e=[],a=[],i=[],s=0;s<t.length;s++){var r=t[s],n=r.indexOf(Math.max.apply(Math,Object(d.a)(r)));Math.random()>r[n]/100?e.push(this.oscillatorType[n]):e.push(this.oscillatorType[0]),i.push(r[n]/100);for(var o=0,l=0;l<r.length;l++)o+=r[l]*this.frequencies[l];a.push(o/100)}console.log(a),this.oscillators.setOscType(e),this.oscillators.setFrequency(a,20*this.state.speed/1e3),this.oscillators.setOscGain(i)}},{key:"getNeighbors",value:function(t,e,a,i){var s=[],r=this.state.personHours;if(t.isIsolating()&&(r*=1-this.state.decreaseInEncountersAfterSymptoms),0===this.state.travelRadius);else if(1===this.state.travelRadius&&4===r)e>0&&s.push(this.grid[e-1][a]),a>0&&s.push(this.grid[e][a-1]),e<this.grid.length-1&&s.push(this.grid[e+1][a]),a<this.grid[0].length-1&&s.push(this.grid[e][a+1]);else for(;s.length<r;){var n=this.chooseRandomNeighbor(t,e,a);s.push(n)}return s}},{key:"togglePlayback",value:function(){0===this.state.numActiveNodes&&(this.generate(!0),console.log("restarting")),this.state.playing?this.oscillators.stop():this.state.playing||this.oscillators.start(),this.setState({playing:!this.state.playing})}},{key:"inInitialPosition",value:function(){return 0===this.state.infectedPerDay.length}},{key:"redraw",value:function(t){if(null!==this.canvas&&void 0!==this.canvas){var e=[this.state.drawNodeOutlines,this.state.longDistaceNetworkActive,this.state.personHours,this.state.travelRadius];if(t||!m.arraysEqual(this.previousDrawingParams,e)){this.previousDrawingParams=e;var a=[this.state.personHours,this.state.travelRadius],i=!m.arraysEqual(this.previousInteractionsParams,a);this.previousInteractionsParams=a;var s=this.canvas.getContext("2d");s.fillStyle="#EEE",s.fillRect(0,0,this.gridWidth,this.gridWidth);for(var r=0;r<this.grid.length;r++)for(var n=0;n<this.grid[r].length;n++){var o=this.grid[r][n];this.drawCell(r,n,o,s,!1)}if(this.props.showInteractions&&(i||this.inInitialPosition())){var l=Math.floor(this.props.gridRows/2),h=l,c=this.grid[l][h],u=this.getNeighbors(c,l,h,null),d=!0,p=!1,f=void 0;try{for(var v,y=u[Symbol.iterator]();!(d=(v=y.next()).done);d=!0){var g=v.value;this.drawCell(g.r,g.c,g,s,!0)}}catch(P){p=!0,f=P}finally{try{d||null==y.return||y.return()}finally{if(p)throw f}}var E=!0,S=!1,D=void 0;try{for(var w,b=u[Symbol.iterator]();!(E=(w=b.next()).done);E=!0){var k=w.value;this.drawInteraction(l,h,k.r,k.c,s)}}catch(P){S=!0,D=P}finally{try{E||null==b.return||b.return()}finally{if(S)throw D}}}}}else console.log("no canvas")}},{key:"drawInteraction",value:function(t,e,a,i,s){var r=this.nodeSize;s.strokeStyle="#000",s.beginPath(),s.moveTo((e+.5)*r,(t+.5)*r),s.lineTo((i+.5)*r,(a+.5)*r),s.stroke()}},{key:"drawCell",value:function(t,a,i,s,r){var n=this.nodeSize,o=t*n,l=a*n;if(i.isExposed())s.fillStyle=w.EXPOSED_COLOR;else if(i.isInfected())i.isIsolating()?s.fillStyle=w.ISOLATING_COLOR:s.fillStyle=w.INFECTED_COLOR;else if(i.isRemoved())s.fillStyle=w.REMOVED_COLOR;else if(i.isDead())s.fillStyle=w.DEAD_COLOR;else if(i.isInQuarentine())s.fillStyle=w.QUARENTINE_COLOR;else if(s.fillStyle=w.SUSCEPTIBLE_COLOR,null!==i.specialDegree){m.assert(i.specialDegree>=4&&i.specialDegree<=8,"node.specialDegree should be between 4 and 8; was: "+i.specialDegree);var h=(i.specialDegree-4)/4;s.fillStyle=y.hex(y.blend(y.makeHex(e.SUSCEPTIBLE_COLOR),y.makeHex("#BBB"),h))}if(s.fillRect(l,o,n-1,n-1),i.isInQuarentine()&&(s.strokeStyle=w.QUARENTINE_STROKE,s.strokeRect(l,o,n-1,n-1)),r||i.linked&&this.state.longDistaceNetworkActive){s.lineWidth=1,s.strokeStyle="#000";var c=l-.5,u=n-1+1;0===l&&(c=.5,u-=1);var d=o-.5,p=n-1+1;0===o&&(d=.5,p-=1),s.strokeRect(c,d,u,p)}}},{key:"renderSlider",value:function(t,a,i,r,n,o,l,h){var c;c=0===l?"":l?s.a.createElement("span",null,"\xa0\xa0\xa0\xa0\xa0",e.renderPercentage(a)):s.a.createElement("span",null,"\xa0\xa0\xa0\xa0\xa0",s.a.createElement("strong",null,Math.round(100*a)/100));return h&&" highlighted",s.a.createElement("div",{className:"slider-container"},s.a.createElement("div",{className:"slider-name"},t,c),s.a.createElement("div",{className:"slider-slider"},s.a.createElement(E.a,{classes:{container:"slider-slider-container",thumbIconWrapper:""},min:r,max:n,step:o,value:a,onChange:i})))}},{key:"render",value:function(){var t=this;this.generate(),this.redraw();var e=this.props.showAllControls,a=null;(e||this.props.showTransmissionProbabilitySlider)&&(a=this.renderSlider("tasa de transmisi\xf3n",this.state.transmissionProbability,function(e,a){t.setState({transmissionProbability:a})},0,this.props.maxTransmissionRate,.01,!1,"transmissionRate"===this.props.highlight));var i=null;if(e||this.props.showImmunityFractionSlider){var r=this.props.immunitySliderName||"Immunity";i=this.renderSlider(r,this.state.immunityFraction,function(e,a){t.setState({immunityFraction:a})},0,1,.01,!0,"immunity"===this.props.highlight)}(e||this.props.showHospitalCapacitySlider)&&this.renderSlider("Hospital capacity",this.state.hospitalCapacityPct,function(e,a){t.setState({hospitalCapacityPct:a})},0,1,.01,!0,!1);var n=null;(e||this.props.showTravelRadiusSlider)&&(n=this.renderSlider("radio de viaje",this.state.travelRadius,function(e,a){t.setState({travelRadius:a})},0,Math.min(30,Math.floor(this.props.gridRows/2)),1,!1,!1));(e||this.props.showPersonHoursSlider)&&this.renderSlider("Encounters per day",this.state.personHours,function(e,a){t.setState({personHours:a})},1,30,1,!1,!1);(e||this.props.showDaysPerStateControls)&&this.renderSlider("Days in incubation",this.state.daysIncubating,function(e,a){t.setState({daysIncubating:a})},0,20,1,!1,!1);(e||this.props.showDaysPerStateControls)&&this.renderSlider("Days with symptoms",this.state.daysSymptomatic,function(e,a){t.setState({daysSymptomatic:a})},1,20,1,!1,!1);(e||this.props.showChanceOfIsolationAfterSymptomsSlider)&&this.renderSlider("cuarentena voluntaria",this.state.chanceOfIsolationAfterSymptoms,function(e,a){t.setState({chanceOfIsolationAfterSymptoms:a})},0,1,.01,!0,!1);(e||this.props.showDecreaseInEncountersAfterSymptomsSlider)&&this.renderSlider("Self-quarantine strictness",this.state.decreaseInEncountersAfterSymptoms,function(e,a){t.setState({decreaseInEncountersAfterSymptoms:a})},0,1,.01,!0,!1);if(e||this.props.showDeathRateSlider){var o="Fatality rate";this.state.hospitalCapacityPct>-1&&(o="Input fatality rate"),this.renderSlider(o,this.state.deathRate,function(e,a){t.setState({deathRate:a})},0,.3,.01,!0,!1)}(e||this.props.showSpeedControls)&&(s.a.createElement(N,{onClick:function(){t.setState({speed:Math.max(0,t.state.speed-.2)})}},"\ud83d\udeb6"),s.a.createElement(N,{onClick:function(){t.setState({speed:Math.min(1,t.state.speed+.2)})}},"\ud83c\udfc3"),this.renderSlider("velocidad",this.state.speed,function(e,a){t.setState({speed:a})},1e-4,1,1e-5,0,!1));var l=null;if(e||this.props.showPlaybackControls){var h=s.a.createElement(N,{onClick:function(){t.setState({playing:!1}),t.generate(!0),t.forceUpdate(),t.resetPlotVariables(),t.oscillators.stop()}},"Reiniciar"),c=s.a.createElement("span",{style:{fontSize:"10pt"}},"\u25b7");this.state.playing&&(c=s.a.createElement("span",null,s.a.createElement("b",null,"||")));var u=s.a.createElement(N,{highlighted:!this.state.playing,onClick:function(){t.togglePlayback()}},c);s.a.createElement(N,{onClick:function(){t.simulateStep(),t.setState({playing:!1})}},"Paso");l=s.a.createElement("div",{className:"playback-controls-container"},h,u)}if(this.props.addLinkedNodes){var d="Long distance: disabled";this.state.longDistaceNetworkActive&&(d="Long distance: enabled"),s.a.createElement("div",null,s.a.createElement("span",{onClick:function(){t.setState({longDistaceNetworkActive:!t.state.longDistaceNetworkActive})}},d))}this.props.showProTip&&s.a.createElement("div",{style:{color:"#666",fontSize:"12pt",marginTop:"1em"}},"\ud83d\udc46 Pro-tip: You can adjust sliders while the simulation is running.");var p=50*this.state.speed,f=null;"transmissionRate"===this.props.highlight?(f=a,a=null):"immunity"===this.props.highlight&&(f=i,i=null);if(this.props.showAliveFraction){var v=this.props.gridRows*this.props.gridRows;s.a.createElement(A,{hospitalCapacity:this.state.hospitalCapacityPct*v,capacityPerDay:this.state.capacityPerDay,deadPerDay:this.state.deadPerDay,infectedPerDay:this.state.infectedPerDay,population:v,recoveredPerDay:this.state.recoveredPerDay,showDeaths:this.props.showDeaths})}return s.a.createElement("div",{className:"simulation-container"},s.a.createElement("div",{className:"automata"},s.a.createElement(k.a,{onEnter:this.onEnter,onLeave:this.onLeave,scrollableAncestor:window},s.a.createElement("canvas",{ref:this.canvasRef,width:this.gridWidth,height:this.gridWidth})),null),s.a.createElement("div",{className:"controls"},s.a.createElement("div",{style:{height:"0.5em"}}),l,f,n,a,i),s.a.createElement("div",{className:"audio"}),s.a.createElement("div",{className:"blankboxr"}),s.a.createElement(D,{milliseconds:p,callback:this.onTick}))}}],[{key:"shuffleInPlace",value:function(t,e){for(var a=t.length-1;a>0;a--){var i=Math.floor(e.random()*(a+1)),s=[t[i],t[a]];t[a]=s[0],t[i]=s[1]}return t}},{key:"renderPercentage",value:function(t){var e=Math.round(100*t);return s.a.createElement("span",null,s.a.createElement("strong",null,e),"%")}}]),e}(i.Component);L.NEIGHBOR_CLASSES=[[[0,0]],[[-1,0],[1,0],[0,-1],[0,1]],[[-1,-1],[-1,1],[1,-1],[1,1]],[[-2,-2],[-2,-1],[-2,0],[-2,1],[-2,2],[-1,2],[0,2],[1,2],[2,2],[2,1],[2,0],[2,-1],[2,-2],[1,-2],[0,-2],[-1,-2]]],L.defaultProps={randomSeed:-1,addCities:!1,addLinkedNodes:!1,gridCols:1,gridRows:1,daysIncubating:5,daysSymptomatic:14,deathRate:.032,decreaseInEncountersAfterSymptoms:.25,chanceOfIsolationAfterSymptoms:.25,hospitalCapacityPct:-1,immunityFraction:.1,maxIterations:-1,nug:20,personHours:5,transmissionProbability:.185,travelRadius:5,drawNodeOutlines:!0,speed:.5,immunitySliderName:"en cuarentena",maxTransmissionRate:1,showAliveFraction:!1,showAllControls:!1,showDaysPerStateControls:!1,showDeaths:!1,showDecreaseInEncountersAfterSymptomsSlider:!1,showChanceOfIsolationAfterSymptomsSlider:!1,showDeathRateSlider:!1,showDegreeSlider:!1,showHospitalCapacitySlider:!1,showImmunityFractionSlider:!1,showInteractions:!1,showPersonHoursSlider:!1,showPlaybackControls:!0,showProTip:!1,showSimulationButtons:!1,showSpeedControls:!1,showTransmissionProbabilitySlider:!1,showTravelRadiusSlider:!1};var j=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(h.a)(this,Object(c.a)(e).call(this,t))).state={spoilersVisible:!1},a}return Object(u.a)(e,t),Object(l.a)(e,[{key:"renderMainPost",value:function(){s.a.createElement("code",{className:"code-exposed"},"you"),s.a.createElement("code",{className:"code-susceptible"},"Susceptible"),s.a.createElement("code",{className:"code-infectious"},"Infected"),s.a.createElement("code",{className:"code-removed"},"Recovered"),s.a.createElement("code",{className:"code-dead"},"Dead"),s.a.createElement("code",{className:"code-quarantined"},"Self-quarantined");return s.a.createElement("div",{className:"main-container"},s.a.createElement(L,{gridRows:60,gridCols:60,hospitalCapacityPct:.05,nodeSize:9,nug:5,randomSeed:52,showAliveFraction:!0,showAllControls:!0,showDeaths:!0,showTransmissionProbabilitySlider:!0,showChanceOfIsolationAfterSymptomsSlider:!0,showTravelRadiusSlider:!0,speed:1,immunityFraction:.1}))}},{key:"render",value:function(){return s.a.createElement("div",{className:"root-container"},s.a.createElement("div",{style:{height:"5em"}}),this.renderMainPost())}}]),e}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(s.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},45:function(t,e,a){},68:function(t,e,a){t.exports=a(180)},73:function(t,e,a){}},[[68,2,1]]]);
//# sourceMappingURL=main.2d0864e7.chunk.js.map